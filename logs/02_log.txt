开始训练...
{'loss': 0.6278, 'grad_norm': 4.176868438720703, 'learning_rate': 1.4173228346456693e-06, 'epoch': 0.04}
{'loss': 0.5215, 'grad_norm': 3.7458653450012207, 'learning_rate': 2.992125984251969e-06, 'epoch': 0.08}
{'loss': 0.3608, 'grad_norm': 3.7181358337402344, 'learning_rate': 4.566929133858268e-06, 'epoch': 0.12}
{'loss': 0.1952, 'grad_norm': 2.34159779548645, 'learning_rate': 6.141732283464567e-06, 'epoch': 0.16}
{'loss': 0.0751, 'grad_norm': 7.072751522064209, 'learning_rate': 7.716535433070867e-06, 'epoch': 0.2}
{'loss': 0.0351, 'grad_norm': 1.0281449556350708, 'learning_rate': 9.291338582677165e-06, 'epoch': 0.24}
{'loss': 0.0116, 'grad_norm': 0.5792966485023499, 'learning_rate': 1.0866141732283466e-05, 'epoch': 0.28}
{'loss': 0.0205, 'grad_norm': 0.35376375913619995, 'learning_rate': 1.2440944881889764e-05, 'epoch': 0.31}
{'loss': 0.0073, 'grad_norm': 4.670076370239258, 'learning_rate': 1.4015748031496063e-05, 'epoch': 0.35}
{'loss': 0.0039, 'grad_norm': 4.657875061035156, 'learning_rate': 1.559055118110236e-05, 'epoch': 0.39}
{'loss': 0.0163, 'grad_norm': 0.01724874973297119, 'learning_rate': 1.7165354330708663e-05, 'epoch': 0.43}
{'loss': 0.0089, 'grad_norm': 1.7480357885360718, 'learning_rate': 1.8740157480314962e-05, 'epoch': 0.47}
{'loss': 0.0446, 'grad_norm': 13.183660507202148, 'learning_rate': 1.9999848909838078e-05, 'epoch': 0.51}
{'loss': 0.0232, 'grad_norm': 0.12414684891700745, 'learning_rate': 1.9994561233548295e-05, 'epoch': 0.55}
{'loss': 0.0092, 'grad_norm': 0.38690248131752014, 'learning_rate': 1.9981723614189646e-05, 'epoch': 0.59}
{'loss': 0.0012, 'grad_norm': 1.5973821878433228, 'learning_rate': 1.9961345749365964e-05, 'epoch': 0.63}
{'loss': 0.0005, 'grad_norm': 0.08138339221477509, 'learning_rate': 1.9933443032621365e-05, 'epoch': 0.67}
{'loss': 0.0043, 'grad_norm': 0.0045587774366140366, 'learning_rate': 1.989803654181189e-05, 'epoch': 0.71}
{'loss': 0.0003, 'grad_norm': 0.11267721652984619, 'learning_rate': 1.9855153023183187e-05, 'epoch': 0.75}
{'loss': 0.0123, 'grad_norm': 1.0643069744110107, 'learning_rate': 1.9804824871166254e-05, 'epoch': 0.79}
{'loss': 0.0141, 'grad_norm': 0.6269623041152954, 'learning_rate': 1.9747090103906523e-05, 'epoch': 0.83}
{'loss': 0.0217, 'grad_norm': 8.133930206298828, 'learning_rate': 1.9681992334544753e-05, 'epoch': 0.87}
{'loss': 0.0041, 'grad_norm': 0.009857174940407276, 'learning_rate': 1.9609580738271438e-05, 'epoch': 0.91}
{'loss': 0.0042, 'grad_norm': 1.1455727815628052, 'learning_rate': 1.952991001517962e-05, 'epoch': 0.94}
{'loss': 0.0065, 'grad_norm': 0.007393007632344961, 'learning_rate': 1.9443040348944157e-05, 'epoch': 0.98}
{'eval_loss': 1.9431712627410889, 'eval_macro_f1': 0.690084063485908, 'eval_runtime': 5.9601, 'eval_samples_per_second': 469.787, 'eval_steps_per_second': 3.691, 'epoch': 1.0}
{'loss': 0.004, 'grad_norm': 0.09963655471801758, 'learning_rate': 1.934903736135866e-05, 'epoch': 1.02}
{'loss': 0.0065, 'grad_norm': 0.027848809957504272, 'learning_rate': 1.924797206276445e-05, 'epoch': 1.06}
{'loss': 0.0012, 'grad_norm': 0.3733927607536316, 'learning_rate': 1.913992079840898e-05, 'epoch': 1.1}
{'loss': 0.0004, 'grad_norm': 0.004403934348374605, 'learning_rate': 1.9024965190774262e-05, 'epoch': 1.14}
{'loss': 0.0001, 'grad_norm': 0.0030916377436369658, 'learning_rate': 1.89031920779188e-05, 'epoch': 1.18}
{'loss': 0.0001, 'grad_norm': 0.005747046787291765, 'learning_rate': 1.8774693447879658e-05, 'epoch': 1.22}
{'loss': 0.0002, 'grad_norm': 0.010012011043727398, 'learning_rate': 1.8639566369184284e-05, 'epoch': 1.26}
{'loss': 0.0007, 'grad_norm': 0.19172531366348267, 'learning_rate': 1.849791291752437e-05, 'epoch': 1.3}
{'loss': 0.0168, 'grad_norm': 0.07523823529481888, 'learning_rate': 1.8349840098647406e-05, 'epoch': 1.34}
{'loss': 0.0038, 'grad_norm': 0.01191539317369461, 'learning_rate': 1.8195459767523953e-05, 'epoch': 1.38}
{'loss': 0.0004, 'grad_norm': 0.005935848690569401, 'learning_rate': 1.803488854385183e-05, 'epoch': 1.42}
{'loss': 0.0315, 'grad_norm': 5.691373825073242, 'learning_rate': 1.7868247723961003e-05, 'epoch': 1.46}
{'loss': 0.0045, 'grad_norm': 0.00619500782340765, 'learning_rate': 1.7695663189185703e-05, 'epoch': 1.5}
{'loss': 0.0008, 'grad_norm': 0.012294706888496876, 'learning_rate': 1.7517265310773014e-05, 'epoch': 1.54}
{'loss': 0.0065, 'grad_norm': 0.01184072159230709, 'learning_rate': 1.7333188851399777e-05, 'epoch': 1.57}
{'loss': 0.0007, 'grad_norm': 0.09359867870807648, 'learning_rate': 1.7143572863372148e-05, 'epoch': 1.61}
{'loss': 0.0002, 'grad_norm': 0.004873717203736305, 'learning_rate': 1.694856058358479e-05, 'epoch': 1.65}
{'loss': 0.0112, 'grad_norm': 0.005481183994561434, 'learning_rate': 1.674829932531896e-05, 'epoch': 1.69}
{'loss': 0.0023, 'grad_norm': 0.013701342977583408, 'learning_rate': 1.6542940366961327e-05, 'epoch': 1.73}
{'loss': 0.0019, 'grad_norm': 4.414111614227295, 'learning_rate': 1.633263883772747e-05, 'epoch': 1.77}
{'loss': 0.0018, 'grad_norm': 0.014748672023415565, 'learning_rate': 1.6117553600476497e-05, 'epoch': 1.81}
{'loss': 0.0053, 'grad_norm': 1.2551484107971191, 'learning_rate': 1.5897847131705194e-05, 'epoch': 1.85}
{'loss': 0.0042, 'grad_norm': 0.02171899378299713, 'learning_rate': 1.5673685398812467e-05, 'epoch': 1.89}
{'loss': 0.0003, 'grad_norm': 0.13383664190769196, 'learning_rate': 1.544523773472669e-05, 'epoch': 1.93}
{'loss': 0.0004, 'grad_norm': 0.0034264943096786737, 'learning_rate': 1.5212676709990762e-05, 'epoch': 1.97}
{'eval_loss': 1.6317217350006104, 'eval_macro_f1': 0.7167751431820243, 'eval_runtime': 5.8868, 'eval_samples_per_second': 475.642, 'eval_steps_per_second': 3.737, 'epoch': 2.0}
{'loss': 0.0002, 'grad_norm': 0.011975936591625214, 'learning_rate': 1.4976178002401408e-05, 'epoch': 2.01}
{'loss': 0.0002, 'grad_norm': 0.005313809495419264, 'learning_rate': 1.4735920264301288e-05, 'epoch': 2.05}
{'loss': 0.0001, 'grad_norm': 0.0018529696390032768, 'learning_rate': 1.4492084987624071e-05, 'epoch': 2.09}
{'loss': 0.0001, 'grad_norm': 0.003581782802939415, 'learning_rate': 1.4244856366794517e-05, 'epoch': 2.13}
{'loss': 0.0008, 'grad_norm': 0.05445035919547081, 'learning_rate': 1.399442115958704e-05, 'epoch': 2.17}
{'loss': 0.0062, 'grad_norm': 0.0026989851612597704, 'learning_rate': 1.3740968546047935e-05, 'epoch': 2.2}
{'loss': 0.0016, 'grad_norm': 0.0014753194991499186, 'learning_rate': 1.348468998558779e-05, 'epoch': 2.24}
{'loss': 0.0002, 'grad_norm': 1.0124629735946655, 'learning_rate': 1.3225779072352066e-05, 'epoch': 2.28}
{'loss': 0.0, 'grad_norm': 0.005612627137452364, 'learning_rate': 1.2964431388979075e-05, 'epoch': 2.32}
{'loss': 0.0055, 'grad_norm': 0.0034895960707217455, 'learning_rate': 1.2700844358855853e-05, 'epoch': 2.36}
{'loss': 0.0004, 'grad_norm': 0.013258102349936962, 'learning_rate': 1.243521709698351e-05, 'epoch': 2.4}
{'loss': 0.0002, 'grad_norm': 0.001862058532424271, 'learning_rate': 1.2167750259564733e-05, 'epoch': 2.44}
{'loss': 0.0001, 'grad_norm': 0.0026407907716929913, 'learning_rate': 1.1898645892427064e-05, 'epoch': 2.48}
{'loss': 0.0, 'grad_norm': 0.001533382455818355, 'learning_rate': 1.1628107278396432e-05, 'epoch': 2.52}
{'loss': 0.0009, 'grad_norm': 0.0012156246230006218, 'learning_rate': 1.1356338783736256e-05, 'epoch': 2.56}
{'loss': 0.0001, 'grad_norm': 0.001058798166923225, 'learning_rate': 1.1083545703768137e-05, 'epoch': 2.6}
{'loss': 0.0011, 'grad_norm': 0.0031734956428408623, 'learning_rate': 1.0809934107790675e-05, 'epoch': 2.64}
{'loss': 0.0, 'grad_norm': 0.0008991784416139126, 'learning_rate': 1.05357106834137e-05, 'epoch': 2.68}
{'loss': 0.0001, 'grad_norm': 0.0012483999598771334, 'learning_rate': 1.0261082580425366e-05, 'epoch': 2.72}
{'loss': 0.0001, 'grad_norm': 0.00087059783982113, 'learning_rate': 9.98625725431013e-06, 'epoch': 2.76}
{'loss': 0.0, 'grad_norm': 0.0010558811482042074, 'learning_rate': 9.71144230953582e-06, 'epoch': 2.8}
{'loss': 0.0, 'grad_norm': 0.0007015420706011355, 'learning_rate': 9.436845342728142e-06, 'epoch': 2.83}
{'loss': 0.0001, 'grad_norm': 0.0006136006559245288, 'learning_rate': 9.162673785851131e-06, 'epoch': 2.87}
{'loss': 0.0004, 'grad_norm': 0.0009952731197699904, 'learning_rate': 8.889134749511956e-06, 'epoch': 2.91}
{'loss': 0.0045, 'grad_norm': 0.02809908241033554, 'learning_rate': 8.616434866508519e-06, 'epoch': 2.95}
{'loss': 0.0001, 'grad_norm': 0.0006572700222022831, 'learning_rate': 8.344780135737962e-06, 'epoch': 2.99}
{'eval_loss': 0.987183153629303, 'eval_macro_f1': 0.8270486499205836, 'eval_runtime': 5.826, 'eval_samples_per_second': 480.603, 'eval_steps_per_second': 3.776, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': 0.0009622846264392138, 'learning_rate': 8.074375766584053e-06, 'epoch': 3.03}
{'loss': 0.0066, 'grad_norm': 0.005263018421828747, 'learning_rate': 7.805426023900938e-06, 'epoch': 3.07}
{'loss': 0.0, 'grad_norm': 0.0009896151022985578, 'learning_rate': 7.538134073710437e-06, 'epoch': 3.11}
{'loss': 0.0016, 'grad_norm': 0.00513729453086853, 'learning_rate': 7.272701829729378e-06, 'epoch': 3.15}
{'loss': 0.0, 'grad_norm': 0.0011404023971408606, 'learning_rate': 7.009329800842929e-06, 'epoch': 3.19}
{'loss': 0.0002, 'grad_norm': 0.0009702151292003691, 'learning_rate': 6.748216939639158e-06, 'epoch': 3.23}
{'loss': 0.0001, 'grad_norm': 0.0013405962381511927, 'learning_rate': 6.489560492119225e-06, 'epoch': 3.27}
{'loss': 0.0, 'grad_norm': 0.0012359691318124533, 'learning_rate': 6.233555848696724e-06, 'epoch': 3.31}
{'loss': 0.0, 'grad_norm': 0.0010212043998762965, 'learning_rate': 5.980396396598777e-06, 'epoch': 3.35}
{'loss': 0.0, 'grad_norm': 0.0007894501322880387, 'learning_rate': 5.730273373780309e-06, 'epoch': 3.39}
{'loss': 0.002, 'grad_norm': 4.0121636390686035, 'learning_rate': 5.483375724461918e-06, 'epoch': 3.43}
{'loss': 0.0, 'grad_norm': 0.0010352869285270572, 'learning_rate': 5.239889956400435e-06, 'epoch': 3.46}
{'loss': 0.0002, 'grad_norm': 0.0013779744040220976, 'learning_rate': 5.000000000000003e-06, 'epoch': 3.5}
{'loss': 0.0001, 'grad_norm': 0.0010654670186340809, 'learning_rate': 4.763887069370107e-06, 'epoch': 3.54}
{'loss': 0.0001, 'grad_norm': 0.0012410294730216265, 'learning_rate': 4.531729525435501e-06, 'epoch': 3.58}
{'loss': 0.0, 'grad_norm': 0.021328533068299294, 'learning_rate': 4.303702741201431e-06, 'epoch': 3.62}
{'loss': 0.0, 'grad_norm': 0.0008928574970923364, 'learning_rate': 4.079978969275984e-06, 'epoch': 3.66}
{'loss': 0.0, 'grad_norm': 0.0013879385078325868, 'learning_rate': 3.860727211749572e-06, 'epoch': 3.7}
{'loss': 0.0003, 'grad_norm': 0.003950946498662233, 'learning_rate': 3.646113092529878e-06, 'epoch': 3.74}
{'loss': 0.0, 'grad_norm': 0.0005576129187829792, 'learning_rate': 3.436298732228699e-06, 'epoch': 3.78}
{'loss': 0.0001, 'grad_norm': 0.24459682404994965, 'learning_rate': 3.231442625695217e-06, 'epoch': 3.82}
{'loss': 0.0, 'grad_norm': 0.0009709132136777043, 'learning_rate': 3.0316995222881584e-06, 'epoch': 3.86}
{'loss': 0.0, 'grad_norm': 0.0007374173728749156, 'learning_rate': 2.83722030897733e-06, 'epoch': 3.9}
{'loss': 0.0, 'grad_norm': 0.0006580965709872544, 'learning_rate': 2.6481518963628383e-06, 'epoch': 3.94}
{'loss': 0.0, 'grad_norm': 0.00081154506187886, 'learning_rate': 2.464637107698046e-06, 'epoch': 3.98}
{'eval_loss': 0.7785907983779907, 'eval_macro_f1': 0.8583739024085515, 'eval_runtime': 5.8154, 'eval_samples_per_second': 481.483, 'eval_steps_per_second': 3.783, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': 0.0006997970631346107, 'learning_rate': 2.286814571000171e-06, 'epoch': 4.02}
{'loss': 0.0, 'grad_norm': 0.0007766155176796019, 'learning_rate': 2.114818614329945e-06, 'epoch': 4.06}
{'loss': 0.0, 'grad_norm': 0.0008187230559997261, 'learning_rate': 1.9487791643195276e-06, 'epoch': 4.09}
{'loss': 0.0, 'grad_norm': 0.000644003099296242, 'learning_rate': 1.788821648025242e-06, 'epoch': 4.13}
{'loss': 0.0, 'grad_norm': 0.0005950697232037783, 'learning_rate': 1.6350668981793304e-06, 'epoch': 4.17}
{'loss': 0.0, 'grad_norm': 0.001448449562303722, 'learning_rate': 1.487631061912298e-06, 'epoch': 4.21}
{'loss': 0.0, 'grad_norm': 0.004337102174758911, 'learning_rate': 1.3466255130147622e-06, 'epoch': 4.25}
{'loss': 0.0, 'grad_norm': 0.0010084521491080523, 'learning_rate': 1.212156767805115e-06, 'epoch': 4.29}
{'loss': 0.0, 'grad_norm': 0.0006965741631574929, 'learning_rate': 1.0843264046665558e-06, 'epoch': 4.33}
{'loss': 0.0, 'grad_norm': 0.0007791259558871388, 'learning_rate': 9.63230987314251e-07, 'epoch': 4.37}
{'loss': 0.0, 'grad_norm': 0.0007077896734699607, 'learning_rate': 8.489619918506098e-07, 'epoch': 4.41}
{'loss': 0.0, 'grad_norm': 0.000981960678473115, 'learning_rate': 7.416057376637543e-07, 'epoch': 4.45}
{'loss': 0.0, 'grad_norm': 0.0005542045109905303, 'learning_rate': 6.412433222214265e-07, 'epoch': 4.49}
{'loss': 0.0, 'grad_norm': 0.0005851582973264158, 'learning_rate': 5.479505598095292e-07, 'epoch': 4.53}
{'loss': 0.0, 'grad_norm': 0.0009206174872815609, 'learning_rate': 4.6179792426163107e-07, 'epoch': 4.57}
{'loss': 0.0, 'grad_norm': 0.00046196929179131985, 'learning_rate': 3.82850495722662e-07, 'epoch': 4.61}
{'loss': 0.0, 'grad_norm': 0.0006963501800782979, 'learning_rate': 3.1116791148704584e-07, 'epoch': 4.65}
{'loss': 0.0, 'grad_norm': 0.0007181589608080685, 'learning_rate': 2.4680432094837394e-07, 'epoch': 4.69}
{'loss': 0.0, 'grad_norm': 0.0006365771987475455, 'learning_rate': 1.8980834469467523e-07, 'epoch': 4.72}
{'loss': 0.0, 'grad_norm': 0.0005872941692359746, 'learning_rate': 1.402230377801761e-07, 'epoch': 4.76}
{'loss': 0.0, 'grad_norm': 0.0006807531462982297, 'learning_rate': 9.80858572012866e-08, 'epoch': 4.8}
{'loss': 0.0001, 'grad_norm': 0.0007217130623757839, 'learning_rate': 6.342863360139672e-08, 'epoch': 4.84}
{'loss': 0.0, 'grad_norm': 0.0007174508064053953, 'learning_rate': 3.627754722584031e-08, 'epoch': 4.88}
{'loss': 0.0, 'grad_norm': 0.0006058532744646072, 'learning_rate': 1.665310814520482e-08, 'epoch': 4.92}
{'loss': 0.0, 'grad_norm': 0.0009704038384370506, 'learning_rate': 4.570140761918085e-09, 'epoch': 4.96}
{'loss': 0.0, 'grad_norm': 0.0005214766715653241, 'learning_rate': 3.777261181947545e-11, 'epoch': 5.0}
{'eval_loss': 0.7992885708808899, 'eval_macro_f1': 0.8570459391354914, 'eval_runtime': 5.8507, 'eval_samples_per_second': 478.579, 'eval_steps_per_second': 3.76, 'epoch': 5.0}
{'train_runtime': 740.4612, 'train_samples_per_second': 218.783, 'train_steps_per_second': 1.715, 'train_loss': 0.017102250514788496, 'epoch': 5.0}
训练完成，保存模型中...
模型已保存到: /home/yangrongjin/LLM-Generated-Text-Detection/best_model
